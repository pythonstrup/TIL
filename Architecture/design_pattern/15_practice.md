# Chapter15. 실전 디자인 패턴

> `패턴 Pattern`은 특정 컨텍스트 내에서 주어진 문제의 해결책이다.

- `컨텍스트 Context`: 패턴이 적용되는 상황. 반복적으로 일어날 수 있는 상황이어야만 한다.
- `문제 Problem`: 컨텍스트 내에서 이뤄야 하는 목표. 여기에는 컨텍스트 내의 제약조건도 포함.
- `해결책 Solution`: 우리가 찾아내야 하는 것. 제약조건 속에서 누가 적용해도 목표를 이룰 수 있는 일반적인 디자인.

> "어떤 컨텍스트 내에서 일련의 제약조건에 의해 영향을 받는 문제가 발생했다면, 그 제약조건 내에서 목적 달성을 위한 해결책이 되는 디자인을 적용하면 된다."

- 왜 이렇게 디자인 패턴의 정의를 따져야 할까?
- 패턴을 정의할 수 있어야 다양한 장점을 제공하는 패턴 카탈로그를 만들 수 있기 때문이다.

#### 패턴은 만들어지는 것이 아니라 발견되는 것이라는 사실을 기억하라.

- 자신이 발견한 디자인 패턴을 제대로 설명할 수만 있다면 누구나 발견했다고 말할 수 있다.

## 새로운 디자인 패턴 발견하기

#### 1. 기존 패턴을 확실하게 파악해야 한다.

- 새로워 보이는 패턴도 잘 따져 보면 기존 패턴을 변형한 것에 불과하다.

#### 2. 오랜 시간 걸쳐서 심사숙고

- 반복적으로 발생하는 문제를 해결할 수 있는 새로운 디자인이 되도록 다듬어야 한다.
  - 적용 범위가 너무 좁아 진짜 패턴이라고 하기 힘든 것도 많다.

#### 3. 패턴을 문서화

- GoF 템플릿을 참조!
  - 패턴의 특성을 설명하는 방법이 마련!

#### 4. 피드백

- 패턴을 설명하는 문서에 피드백을 반영. 다시 검증을 받는 과정을 여러 번 반복.

#### 5. 3의 규칙

- 실전 문제 해결에 3번 이상 적용되어야 패턴 자격을 얻을 수 있다는 점을 기억.

<br/>

## 디자인 패턴 분류하기

- 패턴 카탈로그에서 제시한 `생성`, `행동`, `구조`라는 3가지 범주로 용도에 따라 나눌 수 있습니다.

### 생성 패턴 Creational Pattern

- 객체 인스턴스를 생성하는 패턴으로, 클라이언트와 그 클라이언트가 생성해야 하는 객체 인스턴스 사이의 연결을 끊어 주는 패턴.
- `추상 팩토리`, `팩토리 메소드`, `싱글턴`, 빌더, 프로토타입

### 행동 패턴 Behavioral Pattern

- 클래스와 객체들이 상호작용하는 방법과 역할을 분담하는 방법을 다루는 패턴입니다.
- `전략`, `옵저버`, `상태`, `커맨드`, `반복자`, `템플릿 메소드`, 인터프리터, 역할 변경, 비지터, 중재자, 메멘토

### 구조 패턴 Structure Pattern

- 클래스와 객체를 더 큰 구조로 만들 수 있게 구상을 사용하는 패턴
- `데코레이터`, `컴포지트`, `어댑터`, `프록시`, `퍼사드`, 플라이웨이트, 브리지

## 클래스와 객체 패턴으로도 나눌 수 있다.

### 클래스 패턴 Class Patterns

- 클래스 사이의 관계가 상속으로 어떻게 정의되는지를 다룬다. 클래스 사이의 관계는 대부분 컴파일할 때 결정된다.
- 템플릿 메소드, 팩토리 메소드, 어댑터, 인터프리터

### 객체 패턴 Object Patterns

- 객체 사이의 관계를 다루며, 객체 사이의 관계는 보통 구성으로 정의된다. 일반적으로 실행 중에 관계가 결정되므로 보다 동적이고 유연하다.
- 컴포지트, 비지터, 데코레이터, 퍼사드, 커맨드, 반복자, 전략, 프록시, 책임 연쇄, 옵저버, 메멘토, 브리지, 중재자, 상태, 플라이웨이트, 프로토타입, 추상 팩토리, 빌더, 싱글턴

<br/>

## 패턴으로 생각하기

#### 최대한 단순하게

- 디자인을 할 때 무엇보다도 중요한 원칙은 `최대한 단순한 방법 Keep It Simple`으로 문제를 해결하기이다.
  - <s>"이 문제에 어떻게 패턴을 적용할 수 있을까"</s>
  - "어떻게 하면 단순하게 해결할 수 있을까"에 초점을 맞춰야 한다.
- 정말 단순하게 잘 만들 수 있다면, 굳이 디자인 패턴을 사용할 필요는 없다.
- 가장 단순하고 유연한 디자인을 만들 때 패턴이 있어야 한다면 그 패턴을 적용하면 된다.

#### 디자인 패턴은 만병통치약이 아니다.

- <u>우리가 설계한 디자인에 미칠 영향과 결과</u>를 주의 깊게 생각해 봐야 한다. 

#### 패턴이 필요할 때

- 어떤 경우에 패턴을 써야 할까?
- <u>지금 디자인상의 문제에 적합하다는 확신이 든다면 패턴을 도입</u>해야 한다.
- 만약 더 간단한 해결책이 있다면 패턴을 적용하기 전에 그 해결책의 사용을 고려해 봐야 한다.
- 간단한 해결책으로 불가능하다고 확신을 가지면 해결해야 할 문제와 제약조건을 종합적으로 고려해 봐야 한다.
  - 그래야 그 문제를 해결하는 데 쓸 패턴을 정확하게 집어낼 수 있다.
  - <u>간단한 해결책으로 문제가 해결되는 데도 시스템의 어떤 부분이 변경될 거라고 예측되는 상황에는 디자인 패턴을 적용해야 한다.</u>
  - 발생 가능성이 높은 실질적인 변경에 대비해서 패턴을 적용해야지, 가능성이 그리 높지 않은 가상적인 변경에 대비해서 패턴을 적용하는 일은 바람직하지 않다.
- 리팩토링을 할 때도 패턴 도입을 고려할 수 있다.

#### 리팩토링과 패턴

- 리팩토링의 목적은 행동 변경이 아니라 <u>구조 개선</u>에 있다.
- ex. 조건문이 아주 많은 코드 => 패턴으로 개선

#### 꼭 필요하지 않은 패턴은 빼 버리자. 지금 있는 디자인에서 디자인 패턴을 제거하는 일을 두려워하지 말라.

- 시스템이 점점 복잡해지면서 처음에 기대했던 유연성이 전혀 발휘되지 못한다면 패턴을 과감하게 제거해 버리는 게 낫다.
- 즉, <u>패턴보다 간단한 해결책이 더 나을 것 같다 싶을 때 패턴을 제거</u>하면 된다.

#### 꼭 필요하지 않은 패턴을 미리 적용할 필요는 없습니다.

- 필요하지 않은 데도 괜히 패턴을 추가하는 일은 피하자.
- 괜히 시스템만 복잡해지고, 나중에 그 패턴을 사용하지 않을 수도 있다.

## 패턴을 대하는 마음가짐

- <u>초보자들은 언제나 패턴을 사용하려는 경항이 있다.</u>
  - 많이 연습해보는 것은 좋은 일이다. 그러다 어느 순간, 어떤 디자인이든 될 수 있으며 단순하게 만들어야 한다는 사실을 터득하게 된다.
- <u>경험이 늘어 중급자 수준에 오르면 어떤 상황에 패턴이 필요하고 필요하지 않은지를 파악할 수 있다.</u>
  - 여전히 잘 맞지 않는 패턴을 억지로 적용하려고 하지만, 그 과정에서 정형적인 패턴이 적합하지 않은 상황에서는 패턴을 적당히 변형해서 써야 한다는 사실을 깨닫는다.

### 용어를 공유하는 5가지 방법

#### 1. 디자인 회의
#### 2. 다른 개발자와의 토론
#### 3. 아키텍처 문서
#### 4. 코드 주석

- 클래스와 메소드 이름을 만들 때도 사용 중인 패턴이 분명히 드러날 수 있도록 한다.

#### 5. 개발자 모임

<br/>

# 참고자료

- 헤드퍼스트 디자인패턴, 에릭 프리먼 / 엘리자베스 롭슨 / 케이시 시에라 / 버트 베이츠 지음
