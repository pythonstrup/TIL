# 3장 타입 추론

## item19. 추론 가능한 타입을 사용해 장황한 코드 방지하기

- 아래와 같이 코드의 모든 변수에 타입을 선언하는 것은 비생산적이며 형편없는 스타일로 여겨진다.

```typescript
let x: number = 12;
```

- 그냥 다음처럼만 해도 충분하다.

```typescript
let x = 12;
```

- 타입 추론이 된다면 명시적 타입 구문이 필요하지 않다. 오히려 방해가 된다.
- 이상적인 타입스크립트 코드는 함수/메소드 시그니처에 타입 구문을 포함하지만, 함수 내에서 생성된 지역 변수에는 타입 구문을 넣지 않는다.
  - 타입 구문을 생략하여 방해되는 것들을 최소화하고 코드를 읽는 사람이 구현 로직에 집중할 수 있게 하는 것이 좋다.

```typescript
function logProduct(product: Product) {
  const {id, name, price} = product;
  console.log(id, name, price);
}
```

- 타입 정보가 있는 라이브러리에서 콜백 함수의 매개변수 타입은 자동으로 추론된다.
  - ex) express

```typescript
app.get('/health', (request, response) => {
  response.send('OK');
});
```

### 타입을 명시하고 싶은 몇 가지 상황

#### 1. 객체 리터럴

- 객체 리터럴을 정의할 때, 타입을 명시하면 잉여 속성 체크가 동작한다. => 타입의 오타를 잡는 데 효과적.

#### 2. 함수의 반환 타입

- 아래의 이유들로, 함수에서 타입 구문을 명시하는 것이 좋다.

1. 오류의 위치를 제대로 표시해줄 수 있다. 
  - ex) `Promise<T>`를 반환하는 함수
2. 반환 타입을 명시하면 함수에 대해 더욱 명확하게 알 수 있다.
3. 명명된 타입을 사용할 수 있다. (직관적인 표현을 위해)

### 린터 활용

- `eslint` 규칙 중 `no-inferrable-type`을 사용해서 작성된 모든 타입 구문이 정말로 필요한지 확인할 수 있다.

---

## item20. 다른 타입에는 다른 변수 사용하기

- 자바스크립트에서는 한 변수를 다른 목적을 가지는 다른 타입으로 재사용해도 된다.

```javascript
let id = "12-34-56";
fetchProduct(id);

id = 123456; // 다른 타입 할당 가능
```

- 하지만 타입스크립트에서는 오류가 발생한다.

> 변수의 값은 바뀔 수 있지만 그 타입은 보통 바뀌지 않는다.

- 타입을 바꿀 수 있는 한 가지 방법은 범위를 좁히는 것인데, 새로운 변수값을 포함하도록 확장하는 것이 아니라 타입을 더 작게 제한하는 것이다.
  - 이 관점에 반하는 타입 지정 방법(item41)이 있는데, 이 방법은 어디까지나 예외이지 규칙은 아니다.
- `id`의 타입을 바꾸지 않으려면, `string`과 `number`를 모두 포함할 수 있도록 타입을 확장하면 된다.

```typescript
let id: string|number = "12-34-56";
id = 123456;
```

- 하지만 위와 같이 변수를 무분별하게 재사용하면 타입 체커와 사람 모두에게 혼란을 줄뿐이다.
- 다른 타입에는 별도의 변수를 사용하는 게 좋다. 이유는 아래와 같다.

1. 서로 관련이 없는 두 개의 값을 분리한다.
2. 변수명을 더 구체적으로 지을 수 있다.
3. 타입 추론을 향상시키며, 타입 구문이 필요해진다.
4. 타입이 좀 더 간결해진다.(`string|number` 대신 `string`과 `number`를 사용)
5. `let` 대신 `const`로 변수를 선언하게 된다. `const`로 변수를 선언하면 코드가 간결해지고, 타입 체커가 타입을 추론하기에도 좋다.

- 여기서 주의할 점! 재사용되는 변수와 `가려지는 변수 shadowed variable`를 혼동해서는 안된다.

```typescript
const id = "12-34-56";

{
  const id = 123456; // 정상
}
```
